<!DOCTYPE html>
<html lang="pt,en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link href="https://flutter.dev/">
    <title>FLEETFIX</title>
</head>
<body>
    <header class="bg-dark text-white text-center py-3">
        <img src="Logo_Transdev.png" alt="Ave Mobilidade Logo" class="img-fluid mb-2" style="max-height: 100px;">
        <h1>Transdev</h1>
        <h9>Gestão de Avarias de Frotas</h9>
    </header>
    
    <div class="container my-5">
        <form id="avariaForm" action="https://formspree.io/f/xwkgppze" method="POST">
            <div class="form-group">
                <label for="empresa">Empresa:</label>
                <select name="empresa" class="form-control" required>
                    <option value="" disabled selected>Selecione a Empresa</option>
                    <option value="(80) Avic">AVC (80)</option>
                    <option value="(43) Ave Mobilidade">Ave Mobilidade (43)</option>
                    <option value="(76) Tuba">Tuba (76)</option>
                    <option value="(80) Empresa Horteleira do Geres">EHG (80)</option>
                    <option value="(79) Cavado">Cavado (79)</option>
                    <option value="(80) Verde Minho Transporte">JAF (80) </option>
                    <option value="(44)Ex Arriva">Ex Arriva (44) </option>
                </select>
            </div>

            <div class="form-group">
                <label for="tipo">Tipo (Instalação/Retirada/Avaria):</label>
                <select name="tipo" class="form-control" required>
                    <option value="" disabled selected>Selecione o Tipo</option>
                    <option value="Instalação">Instalação</option>
                    <option value="Retirada">Retirada</option>
                    <option value="Avaria">Avaria</option>
                </select>
            </div>

            <div class="form-group">
                <label for="equipamento">Equipamento:</label>
                <select name="equipamento" class="form-control" required>
                    <option value="" disabled selected>Selecione o Equipamento</option>
                    <option value="Amineo">Amineo</option>
                    <option value="Gateway">Gateway</option>
                    <option value="Connect">Connect</option>
                    <option value="Reflex">Reflex</option>
                </select>
            </div>

            <div class="form-group">
                <label for="frota">Número de Frota (até 6 números):</label>
                <input type="text" name="frota" id="frotaInput" class="form-control" maxlength="6" placeholder="Digite até 6 números" required>
            </div>

            <div class="form-group">
                <label for="numero_serie">Número de Série:</label>
                <input type="text" name="numero_serie" class="form-control" placeholder="Digite o número de série" required>
            </div>

            <div class="form-group">
                <label for="descricao">Descrição:</label>
                <textarea name="descricao" class="form-control" style="text-transform: uppercase;" rows="3" required></textarea>
            </div>

            <button id="btnCadastrarListarAvarias" type="button" class="btn btn-primary mb-2">Cadastrar/Listar Avarias</button>
            <button id="btnEnviarFormulario" type="submit" class="btn btn-success">Enviar Formulário</button>
        </form>
    </div>

    <footer class="bg-dark text-white text-center py-3">
        <p>Desenvolvido: TSM Infraestrutura IT</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="formulario.js" defer></script>
    <script src="https://formspree.io/js/formbutton-v1.min.js" defer></script>
    <script>
    window.formbutton=window.formbutton||function(){(formbutton.q=formbutton.q||[]).push(arguments)};
    formbutton("create", {
        action: "https://formspree.io/f/xwkgppze",
        title: "How can we help?",
        fields: [
{
            type: "email",
            label: "Email:",
            name: "email",
            required: true,
            placeholder: "your@email.com"
    },
        {
            type: "textarea",
            label: "Message:",
            name: "message",
            placeholder: "What's on your mind?",
    },
    { type: "submit" }
        ],
    styles: {
    title: {
    backgroundColor: "gray"
    },
        button: {
        backgroundColor: "gray"
        }
        }
    });
    </script>
    <script>
        document.getElementById('btnCadastrarListarAvarias').addEventListener('click', function() {
            // Comportamento desejado para o botão "Cadastrar/Listar Avarias"
            alert('Cadastrar/Listar Avarias foi clicado!');
            // Redirecionar para outra página ou abrir um modal, por exemplo
            // window.location.href = 'outra_pagina.html';
        });

        document.getElementById('avariaForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Impede o envio padrão do formulário

            const form = event.target;
            const data = new FormData(form);

            fetch(form.action, {
                method: form.method,
                body: data,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    alert('Formulário enviado com sucesso!');
                    form.reset();
                } else {
                    response.json().then(data => {
                        if (Object.hasOwn(data, 'errors')) {
                            alert(data["errors"].map(error => error["message"]).join(", "));
                        } else {
                            alert('Ocorreu um erro ao enviar o formulário.');
                        }
                    });
                }
            }).catch(error => {
                alert('Ocorreu um erro ao enviar o formulário.');
            });
        });
    </script>
</body>
</html>
